<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv='Content-Type' content='text/html;charset=UTF-8' />
    <title>web</title>
    <script id="sap-ui-bootstrap" src="https://sapui5.hana.ondemand.com/resources/sap-ui-core.js"
        data-sap-ui-theme="sap_fiori_3_dark" data-sap-ui-xx-bindingSyntax="complex" data-sap-ui-compatVersion="edge"
        data-sap-ui-async="true">
    </script>
    <script>
        sap.ui.require(['sap/ui/core/Core'], (oCore, ) => {

            sap.ui.getCore().loadLibrary("sap.f", {
                async: true
            }).then(() => {
                let shell = new sap.f.ShellBar("shell")
                shell.setTitle("ABAP File Uploader")
                shell.setShowCopilot(true)
                shell.setShowSearch(true)
                shell.setShowNotifications(true)
                shell.setShowProductSwitcher(true)
                shell.placeAt("uiArea")
                sap.ui.getCore().loadLibrary("sap.ui.layout", {
                    async: true
                }).then(() => {
                    let layout = new sap.ui.layout.VerticalLayout("layout")
                    layout.placeAt("uiArea")
                    let line2 = new sap.ui.layout.HorizontalLayout("line2")
                    sap.ui.getCore().loadLibrary("sap.m", {
                        async: true
                    }).then(() => {})
                    let button = new sap.m.Button("button")
                    button.setText("Upload File")
                    button.attachPress(function () {
                        let oFileUploader = oCore.byId("fileToUpload")
                        if (!oFileUploader.getValue()) {
                            sap.m.MessageToast.show("Choose a file first")
                            return
                        }
                        let oInput = oCore.byId("tablename")
                        if (!oInput.getValue()){
                            sap.m.MessageToast.show("Target Table is Required")
                            return
                        }
                        let param = new sap.ui.unified.FileUploaderParameter()
                        param.setName("tablename")
                        param.setValue( oInput.getValue())
                        oFileUploader.addParameter(param)
                        oFileUploader.upload()
                    })
                    let input = new sap.m.Input("tablename")
                    input.placeAt("layout")
                    input.setRequired(true)
                    input.setWidth("600px")
                    input.setPlaceholder("Target ABAP Table")
                    line2.placeAt("layout")
                    sap.ui.getCore().loadLibrary("sap.ui.unified", {
                        async: true
                    }).then(() => {
                        var fileUploader = new sap.ui.unified.FileUploader(
                            "fileToUpload")
                        fileUploader.setFileType("json")
                        fileUploader.setWidth("400px")
                        fileUploader.placeAt("line2")
                        button.placeAt("line2")
                        fileUploader.setPlaceholder(
                            "Choose File for Upload...")
                        fileUploader.attachUploadComplete(function (oEvent) {
                            alert(oEvent.getParameter("status"))
                        })
                    })
                })
            })
        })
    </script>
</head>
<body class="sapUiBody">
    <div id="uiArea"></div>
</body>

</html>